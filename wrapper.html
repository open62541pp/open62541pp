<!-- https://github.com/doxygen/doxygen/blob/master/templates/html/header.html -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>open62541pp: Wrapper types</title>
<!--BEGIN PROJECT_ICON-->
<!-- <link rel="icon" href="$projecticon" type="image/x-icon" /> -->
<!--END PROJECT_ICON-->
<link rel="icon" type="image/png" sizes="16x16" href="https://open62541pp.github.io//favicon-16x16.png" />
<link rel="icon" type="image/png" sizes="32x32" href="https://open62541pp.github.io//favicon-32x32.png" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<!--BEGIN COPY_CLIPBOARD-->
<script type="text/javascript" src="clipboard.js"></script>
<!--END COPY_CLIPBOARD-->
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="custom.css" rel="stylesheet" type="text/css"/>
<script defer src="https://cloud.umami.is/script.js" data-website-id="e95fb465-e14d-4239-be4d-bad5246adc7a"></script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">open62541pp<span id="projectnumber">&#160;0.18.0</span>
   </div>
   <div id="projectbrief">C++ wrapper of open62541</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="guide.html">Development guide</a></li>  </ul>
</div>
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Wrapper types</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#autotoc_md21">Access native object</a></li>
<li class="level1"><a href="#autotoc_md22">Conversion</a></li>
<li class="level1"><a href="#autotoc_md23">Implicit conversion</a></li>
<li class="level1"><a href="#autotoc_md24">Composed types</a><ul><li class="level2"><a href="#autotoc_md25">Example native type</a></li>
<li class="level2"><a href="#autotoc_md26">Minimal wrapper class</a></li>
<li class="level2"><a href="#autotoc_md27">Adding getters and setters</a></li>
<li class="level2"><a href="#autotoc_md28">Usage example</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p>Wrapper types in <b>open62541pp</b> provide a modern C++ interface to native open62541 objects. They maintain full compatibility with native types while adding features like RAII and pointer interconvertibility.</p>
<p>All wrapper classes derive from <a class="el" href="classopcua_1_1Wrapper.html" title="Template base class to wrap native objects.">opcua::Wrapper</a>. The template type <a class="el" href="classopcua_1_1TypeWrapper.html" title="Template base class to wrap UA_* type objects that require manual memory management.">opcua::TypeWrapper</a> extends <a class="el" href="classopcua_1_1Wrapper.html" title="Template base class to wrap native objects.">opcua::Wrapper</a> class to safely copy, move and delete native types with heap-allocated memory.</p>
<h1><a class="anchor" id="autotoc_md21"></a>
Access native object</h1>
<p>The native object can be accessed in two ways:</p><ul>
<li>Using the <a class="el" href="classopcua_1_1Wrapper.html#aaa0b3bd9c7b644f3c99f7bf841565faa" title="Return pointer to native object.">opcua::Wrapper::handle()</a> function</li>
<li>Using the <a class="el" href="classopcua_1_1Wrapper.html#a69fc9b6017ae88c2dc64bf094efff806" title="Member access to native object.">opcua::Wrapper::operator-&gt;()</a> function to access members of the native type</li>
</ul>
<div class="fragment"><div class="line"><a class="code hl_class" href="classopcua_1_1DataValue.html">opcua::DataValue</a> wrapper;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Access native pointer</span></div>
<div class="line"><a class="code hl_structRef" target="_blank" href="open62541/structUA__DataValue.html">UA_DataValue</a>* native = wrapper.<a class="code hl_function" href="classopcua_1_1Wrapper.html#aaa0b3bd9c7b644f3c99f7bf841565faa">handle</a>();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Access native members directly</span></div>
<div class="line">wrapper-&gt;statusCode = <a class="code hl_defineRef" target="_blank" href="open62541/statuscodes_8h.html#a3c68d30bc6f32228aa43be75fdc9d5aa">UA_STATUSCODE_GOOD</a>;  <span class="comment">// Equivalent to:</span></div>
<div class="line">wrapper.<a class="code hl_function" href="classopcua_1_1Wrapper.html#aaa0b3bd9c7b644f3c99f7bf841565faa">handle</a>()-&gt;statusCode = <a class="code hl_defineRef" target="_blank" href="open62541/statuscodes_8h.html#a3c68d30bc6f32228aa43be75fdc9d5aa">UA_STATUSCODE_GOOD</a>;</div>
<div class="ttc" id="aclassopcua_1_1DataValue_html"><div class="ttname"><a href="classopcua_1_1DataValue.html">opcua::DataValue</a></div><div class="ttdoc">UA_DataValue wrapper class.</div><div class="ttdef"><b>Definition</b> <a href="types_8hpp_source.html#l01849">types.hpp:1849</a></div></div>
<div class="ttc" id="aclassopcua_1_1Wrapper_html_aaa0b3bd9c7b644f3c99f7bf841565faa"><div class="ttname"><a href="classopcua_1_1Wrapper.html#aaa0b3bd9c7b644f3c99f7bf841565faa">opcua::Wrapper::handle</a></div><div class="ttdeci">constexpr T * handle() noexcept</div><div class="ttdoc">Return pointer to native object.</div><div class="ttdef"><b>Definition</b> <a href="wrapper_8hpp_source.html#l00082">wrapper.hpp:82</a></div></div>
<div class="ttc" id="astatuscodes_8h_html_a3c68d30bc6f32228aa43be75fdc9d5aa"><div class="ttname"><a href="open62541/statuscodes_8h.html#a3c68d30bc6f32228aa43be75fdc9d5aa">UA_STATUSCODE_GOOD</a></div><div class="ttdeci">#define UA_STATUSCODE_GOOD</div></div>
<div class="ttc" id="astructUA__DataValue_html"><div class="ttname"><a href="open62541/structUA__DataValue.html">UA_DataValue</a></div></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md22"></a>
Conversion</h1>
<p>Both <a class="el" href="classopcua_1_1Wrapper.html" title="Template base class to wrap native objects.">opcua::Wrapper</a> and <a class="el" href="classopcua_1_1TypeWrapper.html" title="Template base class to wrap UA_* type objects that require manual memory management.">opcua::TypeWrapper</a> are <em>pointer-interconvertible</em> with the wrapped native type.</p>
<p>Pointer interconvertibility enables lightweight casting between wrapper and native types without additional overhead. This is achieved by ensuring the wrapper class is a standard-layout type, as required by the C++ standard.</p>
<blockquote class="doxtable">
<p>&zwj;Two objects <code>a</code> and <code>b</code> are pointer-interconvertible if: One is a standard-layout class object [wrapper] and the other is the first non-static data member of that object [wrapped native type]. Derived classes must fulfill the requirements of standard-layout types to be convertible. </p><dl class="section see"><dt>See also</dt><dd><a href="https://en.cppreference.com/w/cpp/language/static_cast#pointer-interconvertible">https://en.cppreference.com/w/cpp/language/static_cast#pointer-interconvertible</a> </dd></dl>
</blockquote>
<p>Following function allow seamless conversions between wrapper and native objects:</p>
<ul>
<li>Convert native objects to wrapper objects using:<ul>
<li>opcua::asWrapper(NativeType*)</li>
<li>opcua::asWrapper(const NativeType*)</li>
<li>opcua::asWrapper(NativeType&amp;)</li>
<li>opcua::asWrapper(const NativeType&amp;)</li>
</ul>
</li>
<li>Convert wrapper objects to native objects using:<ul>
<li>opcua::asNative(WrapperType*)</li>
<li>opcua::asNative(const WrapperType*)</li>
<li>opcua::asNative(WrapperType&amp;)</li>
<li>opcua::asNative(const WrapperType&amp;)</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md23"></a>
Implicit conversion</h1>
<p>Implicit conversions to the native object are provided for convenience:</p>
<div class="fragment"><div class="line"><a class="code hl_class" href="classopcua_1_1DataValue.html">opcua::DataValue</a> wrapper;</div>
<div class="line"><a class="code hl_structRef" target="_blank" href="open62541/structUA__DataValue.html">UA_DataValue</a>&amp; native = wrapper;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Pass wrapper objects directly to functions expecting native types</span></div>
<div class="line"><span class="keywordtype">void</span> print(<a class="code hl_structRef" target="_blank" href="open62541/structUA__DataValue.html">UA_DataValue</a>&amp; dv) { <span class="comment">/* ... */</span> }</div>
<div class="line">print(wrapper);                  <span class="comment">// implicit conversion</span></div>
<div class="line">print(opua::asNative(wrapper));  <span class="comment">// explicit alternative</span></div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md24"></a>
Composed types</h1>
<p>When wrapping composed types with nested members, getters and setters are essential for accessing these members as wrapper types. Let's walk through an example to demonstrate how to implement such functionality.</p>
<h2><a class="anchor" id="autotoc_md25"></a>
Example native type</h2>
<div class="fragment"><div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * ReadValueId</span></div>
<div class="line"><span class="comment"> * ^^^^^^^^^^^</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line">    <a class="code hl_structRef" target="_blank" href="open62541/structUA__NodeId.html">UA_NodeId</a> nodeId;</div>
<div class="line">    <a class="code hl_typedefRef" target="_blank" href="open62541/types_8h.html#a5f0721b034e4c44a7f81589b15ba1baf">UA_UInt32</a> attributeId;</div>
<div class="line">    <a class="code hl_structRef" target="_blank" href="open62541/structUA__String.html">UA_String</a> indexRange;</div>
<div class="line">    <a class="code hl_structRef" target="_blank" href="open62541/structUA__QualifiedName.html">UA_QualifiedName</a> dataEncoding;</div>
<div class="line">} <a class="code hl_structRef" target="_blank" href="open62541/structUA__ReadValueId.html">UA_ReadValueId</a>;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define UA_TYPES_READVALUEID 123</span></div>
<div class="ttc" id="astructUA__NodeId_html"><div class="ttname"><a href="open62541/structUA__NodeId.html">UA_NodeId</a></div></div>
<div class="ttc" id="astructUA__QualifiedName_html"><div class="ttname"><a href="open62541/structUA__QualifiedName.html">UA_QualifiedName</a></div></div>
<div class="ttc" id="astructUA__ReadValueId_html"><div class="ttname"><a href="open62541/structUA__ReadValueId.html">UA_ReadValueId</a></div></div>
<div class="ttc" id="astructUA__String_html"><div class="ttname"><a href="open62541/structUA__String.html">UA_String</a></div></div>
<div class="ttc" id="atypes_8h_html_a5f0721b034e4c44a7f81589b15ba1baf"><div class="ttname"><a href="open62541/types_8h.html#a5f0721b034e4c44a7f81589b15ba1baf">UA_UInt32</a></div><div class="ttdeci">uint32_t UA_UInt32</div></div>
</div><!-- fragment --><p>In this case, the struct contains heap-allocated members (<code>nodeId</code>, <code>indexRange</code>, and <code>dataEncoding</code>). To manage these members correctly, our wrapper should inherit from <a class="el" href="classopcua_1_1TypeWrapper.html" title="Template base class to wrap UA_* type objects that require manual memory management.">opcua::TypeWrapper</a>.</p>
<h2><a class="anchor" id="autotoc_md26"></a>
Minimal wrapper class</h2>
<p>A minimal wrapper implementation looks like this:</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>ReadValueId : <span class="keyword">public</span> TypeWrapper&lt;UA_ReadValueId, UA_TYPES_READVALUEID&gt; {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="comment">// Inherit constructors</span></div>
<div class="line">    <span class="keyword">using </span>TypeWrapper::TypeWrapper;</div>
<div class="line">};</div>
</div><!-- fragment --><p>We can now use the wrapper like this:</p>
<div class="fragment"><div class="line">ReadValueId rv;</div>
<div class="line">rv-&gt;attributeId = 1;</div>
<div class="line">// How to set access nodeId?</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md27"></a>
Adding getters and setters</h2>
<p>To handle nested members like <code>nodeId</code>, we can use the opcua::asWrapper helper function to access these members as their corresponding wrapper types. Below is the enhanced wrapper class with getter and setter methods:</p>
<div class="fragment"><div class="line"><span class="keyword">class </span>ReadValueId : <span class="keyword">public</span> <a class="code hl_class" href="classopcua_1_1TypeWrapper.html">opcua::TypeWrapper</a>&lt;UA_ReadValueId, UA_TYPES_READVALUEID&gt; {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="comment">// Inherit constructors</span></div>
<div class="line">    <span class="keyword">using </span>TypeWrapper::TypeWrapper;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> setNodeId(<a class="code hl_class" href="classopcua_1_1NodeId.html">opcua::NodeId</a> nodeId) {</div>
<div class="line">        asWrapper&lt;opcua::NodeId&gt;(handle()-&gt;nodeId) = std::move(nodeId);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="classopcua_1_1NodeId.html">opcua::NodeId</a>&amp; nodeId() const noexcept {</div>
<div class="line">        <span class="keywordflow">return</span> asWrapper&lt;opcua::NodeId&gt;(handle()-&gt;nodeId);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_class" href="classopcua_1_1NodeId.html">opcua::NodeId</a>&amp; nodeId() noexcept {</div>
<div class="line">        <span class="keywordflow">return</span> asWrapper&lt;opcua::NodeId&gt;(handle()-&gt;nodeId);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    uint32_t attributeId() const noexcept {</div>
<div class="line">        <span class="keywordflow">return</span> handle()-&gt;attributeId;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// ...</span></div>
<div class="line">};</div>
<div class="ttc" id="aclassopcua_1_1NodeId_html"><div class="ttname"><a href="classopcua_1_1NodeId.html">opcua::NodeId</a></div><div class="ttdoc">UA_NodeId wrapper class.</div><div class="ttdef"><b>Definition</b> <a href="types_8hpp_source.html#l00665">types.hpp:665</a></div></div>
<div class="ttc" id="aclassopcua_1_1TypeWrapper_html"><div class="ttname"><a href="classopcua_1_1TypeWrapper.html">opcua::TypeWrapper</a></div><div class="ttdoc">Template base class to wrap UA_* type objects that require manual memory management.</div><div class="ttdef"><b>Definition</b> <a href="typewrapper_8hpp_source.html#l00024">typewrapper.hpp:24</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md28"></a>
Usage example</h2>
<p>With these getters and setters, accessing and modifying <code>nodeId</code> becomes straightforward:</p>
<div class="fragment"><div class="line">ReadValueId rv;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Set nodeId using the NodeId wrapper</span></div>
<div class="line">rv.setNodeId(<a class="code hl_class" href="classopcua_1_1NodeId.html">opcua::NodeId</a>(1, <span class="stringliteral">&quot;Identifier&quot;</span>));</div>
<div class="line"><span class="comment">// Access nodeId</span></div>
<div class="line"><a class="code hl_class" href="classopcua_1_1NodeId.html">opcua::NodeId</a>&amp; currentNodeId = rv.nodeId();</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8
</small></address>
</body>
</html>
